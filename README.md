Performs data fetch, cleanup and then stores back to supabase
